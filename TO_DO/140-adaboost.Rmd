# Adaboost - Bagged Adaboost Using `adabag` & `plyr`

```{r, include=FALSE}
library(knitr)
knitr::opts_chunk$set(cache = TRUE, 
                      warning = FALSE, 
                      message = FALSE, 
                      cache.lazy = FALSE)
```

## Summary

'Bagged Adaboost' = adabag

References: https://en.wikibooks.org/wiki/Data_Mining_Algorithms_In_R/Classification/adaboost

Adaboost Algorithm

Input:

$(x_i, y_1),...,(x_n, y_l)$

Therefore, given a set of labeled pairs of data: 

$(x_i, y_i),~~ i = 1, ..., l~~$   where  $~~x_i \in R^n~~$ and $~~y \in \{1, -1\}^l$    
Such that $~~f(x_i) = \left\{ \begin{array}{cc} \geq 0; ~y_i = 1 \\ ~~< 0; ~y_i = -1 \end{array} \right\}$
Where f($x_i$) = \brace 

Note:

- https://stackoverflow.com/questions/18402016/error-when-i-try-to-predict-class-probabilities-in-r-caret#comment99205329_36573563
- test <- factor(c("level1", "level 2")) 
- levels(Class) # Should return: [1] "level 2" "level1" 
- make.names(levels(Class)) # Should return: [1] "level.2" "level1"

## Pseudocode



## Hyper-parameters

## Big O

## Model Training & Tuning

Libraries
```{r, message=FALSE, warning=FALSE}
Libraries = c("doMC", "caret", "adabag", "plyr", "beepr")

for(p in Libraries){  # Install if not present
    if(!require(p, character.only = TRUE)) { install.packages(p, dependencies = TRUE) }
    library(p, character.only = TRUE)
}
```

Import data & data handling

```{r}
test_harness_paa <- read.csv("data/test_harness_paa.csv")
test_harness_paa <- test_harness_paa[, -c(2,3)]
Class <- as.factor(test_harness_paa$Class) # Convert ‘Class’ To Factor
```

Partition data - training / testing sets

```{r}
set.seed(1000)
index <- createDataPartition(test_harness_paa$Class, p = 0.8, list = FALSE)

training_set <- test_harness_paa[ index,]
test_set     <- test_harness_paa[-index,]

Class_test <- as.factor(test_set$Class)
```

### Run Training Set 
 
```{r cache=TRUE}
set.seed(1000)
registerDoMC(cores = 3) # Start multi-processor mode
start_time <- Sys.time() # Start timer

my_grid1 <- expand.grid(mtry = 1:4)

model_list <- train(Class ~ .,
                    data = training_set,
                    methodList = "Adabag",
                    tcontrol = my_grid1)
                    #preProcess = c("scale","center")) # preProcess = c("scale","center")

end_time <- Sys.time()   # End timer
end_time - start_time    # Display time
registerDoSEQ() # Stop multi-processor mode
```

### Display Model Results

Model summary

```{r}
model_list
```

## Predictions - Run Test Set

Predict test set
 
```{r}
Predicted_test_vals <- predict(model_list, test_set[,-1])

length(Predicted_test_vals)
```

Quick summary

```{r}
summary(Predicted_test_vals)
```

## Confusion matrix

```{r}
confusionMatrix(Predicted_test_vals, Class_test)
```




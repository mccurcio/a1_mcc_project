# Expectation Maximization

```{r, include=FALSE}
library(knitr)
knitr::opts_chunk$set(cache = TRUE, 
                      warning = FALSE, 
                      message = FALSE, 
                      cache.lazy = FALSE)
```

## Summary

Cluster Types    

- K-means clustering  
- K-Medoid clustering  
- Expectation maximization (EM) clustering  
- Hierarchical clustering  

References  

- https://rpubs.com/kaz_yos/epi288-cluster  
- The Elements of Statistical Learning: http://www-stat.stanford.edu/~tibs/ElemStatLearn/  
- CRAN Task View: http://cran.r-project.org/web/views/Cluster.html  
- http://en.wikibooks.org/wiki/Data_Mining_Algorithms_In_R/Clustering/Expectation_Maximization_(EM) 

### https://rpubs.com/JanpuHou/298239

EM clustering using mclust::em() ????????????????/
library(mclust)
- Classify into mixture of normal distributions.  

## Pseudocode

X = (Y, Z)

- Complete data X(eg. what we’d like to have!)  
- Observed data Y(eg. individual observations)  
- Missing data Z(eg. class assignments)  

The algorithm  
- Use estimated parameters to infer Z  
- Update estimated parameters using Y and Z  
- Repeat until convergence  


E-M Algorithm

- Consider a set of starting parameters  
- Use these to “estimate” the missing data  
- Use “complete” data to update parameters  
- Repeat as necessary  


## Hyper-parameters


## Big O


## Model Training & Tuning

Libraries
```{r, message=FALSE, warning=FALSE}
Libraries = c("doMC", "caret", "mclust")

for(p in Libraries){  # Install if not present
    if(!require(p, character.only = TRUE)) { install.packages(p, dependencies = TRUE) }
    library(p, character.only = TRUE)
}
```

Import data & data handling

```{r}
test_harness_paa <- read.csv("data/test_harness_paa.csv")
test_harness_paa <- test_harness_paa[, -c(2,3)]
Class <- as.factor(test_harness_paa$Class) # Convert ‘Class’ To Factor
```

Partition data - training / testing sets
```{r}
set.seed(1000)
index <- createDataPartition(test_harness_paa$Class, p = 0.8, list = FALSE)

training_set <- test_harness_paa[ index,]
test_set     <- test_harness_paa[-index,]

Class_test <- as.factor(test_set$Class)
```

### Run Training Set 
 
```{r, cache=TRUE}
set.seed(1000)
start_time <- Sys.time() # Start timer

vars <- names(test_harness_paa[,-1]) # Extract variables for analysis

num.clusters <- 1:10 # Try 1 to 20 clusters

test_harness_paa.Mclust <- Mclust(test_harness_paa[ ,vars]) # Number of clusters

end_time <- Sys.time() # End timer
end_time - start_time # Display time
```

### Display Model Results

Model Summary

```{r}
test_harness_paa.Mclust
```

```{r, cache=TRUE}
summary(test_harness_paa.Mclust)
```

```{r, cache=TRUE}
plot(test_harness_paa.Mclust, what = "BIC")
```

```{r eval=FALSE, cache=TRUE, include=FALSE}
plot(test_harness_paa.Mclust, what = "classification", dimens = c(3,12))
```

```{r eval=FALSE, cache=TRUE, include=FALSE}
plot(test_harness_paa.Mclust, what = "uncertainty", dimens = c(3,12))
```

```{r, cache=TRUE}
#plot(test_harness_paa.Mclust, what = "density")
```

## Predict Test Set

```{r}
Predicted_test_vals <- predict(test_harness_paa.Mclust, test_set[, -1])

length(Predicted_test_vals)
```

Quick Summary

```{r}
summary(Predicted_test_vals)
```

Confusion Matrix

```{r}
confusionMatrix(Predicted_test_vals, 
                Class_test)
```


## Summary









